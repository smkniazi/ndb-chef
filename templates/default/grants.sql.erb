# Give access from this IP
CREATE USER if not exists '<%= node['mysql']['user'] %>'@'localhost' identified by '<%= node['mysql']['password'] %>';
CREATE USER if not exists '<%= node['mysql']['user'] %>'@'127.0.0.1' identified by '<%= node['mysql']['password'] %>';
CREATE USER if not exists '<%= node['mysql']['user'] %>'@'%' identified by '<%= node['mysql']['password'] %>';
CREATE USER if not exists '<%= node['mysql']['user'] %>'@'<%= @my_ip %>' identified by '<%= node['mysql']['password'] %>';

GRANT NDB_STORED_USER ON *.* TO '<%= node['mysql']['user'] %>'@'localhost';
GRANT NDB_STORED_USER ON *.* TO '<%= node['mysql']['user'] %>'@'127.0.0.1';
GRANT NDB_STORED_USER ON *.* TO '<%= node['mysql']['user'] %>'@'%';
GRANT NDB_STORED_USER ON *.* TO '<%= node['mysql']['user'] %>'@'<%= @my_ip %>';

GRANT ALL PRIVILEGES ON *.* to '<%= node['mysql']['user'] %>'@'localhost';
GRANT ALL PRIVILEGES ON *.* to '<%= node['mysql']['user'] %>'@'127.0.0.1'; 
<% if node['install']['localhost'].casecmp?("false") -%>
GRANT ALL PRIVILEGES ON *.* to '<%= node['mysql']['user'] %>'@'<%= @my_ip %>';
GRANT ALL PRIVILEGES ON *.* to '<%= node['mysql']['user'] %>'@'%';
<% end -%>
GRANT GRANT OPTION ON *.* to '<%= node['mysql']['user'] %>'@'localhost';
GRANT GRANT OPTION ON *.* to '<%= node['mysql']['user'] %>'@'127.0.0.1';
<% if node['install']['localhost'].casecmp?("false") -%>
GRANT GRANT OPTION ON *.* to '<%= node['mysql']['user'] %>'@'<%= @my_ip %>';
GRANT GRANT OPTION ON *.* to '<%= node['mysql']['user'] %>'@'%';
<% end -%>
